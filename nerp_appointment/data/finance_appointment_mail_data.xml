<?xml version="1.0"?>
<odoo>
    <data noupdate="0">

        <!-- Meeting invitation sent to attendees when a meeting has been scheduled -->
        <record id="finance_calendar_template_meeting_invitation" model="mail.template">
            <field name="name">Calendar: Finance Meeting Invitation</field>
            <field name="model_id" ref="calendar.model_calendar_attendee"/>
            <field name="subject">${object.common_name}, Your service session with Odoo Accounting is scheduled</field>
            <field name="email_from">${object.event_id.company_id.partner_id.email_formatted | safe}</field>
            <field name="email_to">
                ${(object.email|safe)}
            </field>
            <field name="email_cc">
                ${('contact@novobi.com' if object.partner_id and object.partner_id.user_ids and object.partner_id.user_ids[0].share == False else ''|safe)}
            </field>
            <field name="reply_to">${object.event_id.company_id.email_reply_to | safe}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html" type="html">
                <body style="box-sizing: border-box;font-size: 1rem;font-weight: 400;line-height: 1.5;color: #212529;text-align: left;background-color: #fff;max-width: 700px;margin: 0 auto!important;">
                    <div style="box-sizing: border-box;margin: 25px;">
                        % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined':
                        'red'}
                        % set topics = object.event_id.get_select_topics()
                        % set company = object.event_id.company_id
                        <div style="box-sizing: border-box;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 49%;">
                                        <img class="logo" alt="logo" style="box-sizing: border-box;width: 100%;"
                                             src="/logo.png?company=${company.id}"/>
                                    </td>
                                    <td style="width: 2%;"/>
                                    <td style="width: 49%;">
                                        <div style="box-sizing: border-box ;float: right;text-align: right;right: 0;top: 20px;">
                                            <!-- <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0.5rem;font-weight: bold;line-height: 25px;font-size: 16px;text-align: right;color: #242424;">
                                                ${object.event_id.event_holder.name}
                                            </h4> -->
                                            <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 1rem;font-size: 16px;text-align: right;color: #242424;">
                                                Your Support Session is Scheduled!
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div style="box-sizing: border-box;border-bottom: solid 1px #9797972e; float:clear"></div>
                        <div style="box-sizing: border-box;margin-top: 0px;">
                            <div style="box-sizing: border-box;margin: 25px 0px;">
                                <h4 style="box-sizing: border-box;margin-top: 0;margin-bottom: 0;font-weight: bold;line-height: 1.71;font-size: 14px;color: #242424;">
                                    Hello ${object.common_name},
                                </h4>
                                <br/>
                                <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424;">
                                    Your Odoo Accounting support session
                                    % if object.partner_id.user_id and object.partner_id.commercial_company_name
                                    for ${object.partner_id.commercial_company_name}
                                    % endif
                                    has been scheduled.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424;">
                                    Please download Zoom prior to your scheduled session so you can access the meeting.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424;">
                                    Download Zoom for free here:
                                    <a target="_blank" href="https://zoom.us">Zoom.us</a>
                                </p>
                            </div>
                            <div style="box-sizing: border-box;margin: 20px 0px;display: flex;justify-content: center;">
                                <a type="a"
                                   href="/services/appointment/calendar/?access_token=${object.event_id.access_token}&amp;reschedule=True"
                                   style="box-sizing: border-box;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;font-family: 'SF UI Display Regular';margin-right: 10px;min-width: 150px;text-align: center;">
                                    Reschedule
                                </a>
                                <a type="a"
                                   href="/services/appointment/view/${object.event_id.access_token}?message=new"
                                   style="box-sizing: border-box;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;font-family: 'SF UI Display Regular';margin-right: 10px;min-width: 150px;text-align: center;">
                                    View
                                </a>
                            </div>
                            <!--                            <div style="box-sizing: border-box;background-color: #f4f4f4;border-radius: 3px;padding: 20px;">-->
                            <div>
                                <table style="background-color:#f4f4f4; padding: 20px">
                                    <tr style="box-sizing: border-box;">
                                        <td style="background-color: #9d668f;color: #fff;padding: 10px;margin-bottom: 20px;">
                                            <div style="box-sizing: border-box;padding: 10px;">
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;padding-bottom: 10px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('dayname', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;font-size: 50px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('day', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;text-align: center;padding: 5px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 1rem;margin: 0;">
                                                        ${object.event_id.get_interval('month', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                    </p>
                                                </div>
                                            </div>
                                            <div style="box-sizing: border-box;border-radius: 5px;background-color: #704866;padding: 10px;text-align: center;font-size: 14px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                ${not object.event_id.allday and object.event_id.get_time_interval(tz=object.event_id.appointment_type_id.appointment_tz) or ''}
                                            </div>
                                        </td>
                                        <td width="20px;"></td>
                                        <td style="padding-top: 5px;">
                                            <p>
                                                <strong>Session Details</strong>
                                            </p>
                                            <table style="width: 100%">
                                                % if not object.event_id.allday and object.event_id.duration
                                                <tr>
                                                    <th>Duration:</th>
                                                    <td>
                                                        ${(object.event_id.duration * 60)|int } minutes
                                                    </td>
                                                </tr>
                                                % endif
                                                % if object.event_id.location:
                                                <tr>
                                                    <th>Location:</th>
                                                    <td>
                                                        <a target="_blank" href="${object.event_id.zoom_join_url}">
                                                            ${object.event_id.zoom_join_url}
                                                        </a>
                                                    </td>
                                                </tr>
                                                % endif
                                                <tr>
                                                    <td colspan="2">
                                                        % if len(topics):
                                                        <strong>Description:</strong>
                                                        <div>
                                                            Odoo Accounting live support session featuring:
                                                            <ul>
                                                                % for topic in topics:
                                                                <li>
                                                                    ${topic}
                                                                </li>
                                                                % endfor
                                                            </ul>
                                                        </div>
                                                        % endif
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </body>
            </field>
            <field name="auto_delete" eval="True"/>
            <field name="user_signature" eval="False"/>
        </record>

        <!-- Reschedule meeting confirmation email -->
        <record id="finance_calendar_template_meeting_changedate" model="mail.template">
            <field name="name">Calendar: Finance Date updated</field>
            <field name="model_id" ref="calendar.model_calendar_attendee"/>
            <field name="subject">RESCHEDULE CONFIRMED: Your service session with Odoo Accounting has been rescheduled</field>
            <field name="email_from">${object.event_id.company_id.partner_id.email_formatted | safe}</field>
            <field name="email_to">
                ${(object.email|safe)}
            </field>
            <field name="email_cc">
                ${('contact@novobi.com' if object.partner_id and object.partner_id.user_ids and object.partner_id.user_ids[0].share == False else ''|safe)}
            </field>
            <field name="reply_to">${object.event_id.company_id.email_reply_to | safe}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html" type="html">
                <body style="box-sizing: border-box;font-size: 1rem;font-weight: 400;line-height: 1.5;color: #212529;text-align: left;background-color: #fff;max-width: 600px;margin: 0 auto!important;">
                    <div style="box-sizing: border-box; margin: 25px;">
                        % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined':
                        'red'}
                        % set topics = object.event_id.get_select_topics()
                        % set company = object.event_id.company_id
                        <div style="box-sizing: border-box;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 49%;">
                                        <img class="logo" alt="logo" style="box-sizing: border-box;width: 100%;"
                                             src="/logo.png?company=${company.id}"/>
                                    </td>
                                    <td style="width: 2%;"/>
                                    <td style="width: 49%;">
                                        <div style="box-sizing: border-box ;float: right;text-align: right;right: 0;top: 20px;">
                                            <!-- <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0.5rem;font-weight: bold;line-height: 25px;font-size: 16px;text-align: right;color: #242424;">
                                                ${object.event_id.event_holder.name}
                                            </h4> -->
                                            <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 1rem;font-size: 16px;text-align: right;color: #242424;">
                                                Your Support Session has been Rescheduled.
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div style="box-sizing: border-box;border-bottom: solid 1px #9797972e; float:clear"></div>
                        <div style="box-sizing: border-box ;margin-top: 0px;">
                            <div style="box-sizing: border-box ;margin: 25px 0px;">
                                <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-weight: bold;line-height: 1.71;font-size: 14px;color: #242424 ;">
                                    Hello ${object.common_name},
                                </h4>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Your support session has been rescheduled.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Please download Zoom prior to your scheduled support session so you can access the
                                    meeting.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Download Zoom for free here:
                                    <a target="_blank" href="https://zoom.us">Zoom.us</a>
                                </p>
                            </div>
                            <div style="box-sizing: border-box ;margin: 20px 0px;display: flex;justify-content: center;">
                                <a href="/services/appointment/calendar/?access_token=${object.event_id.access_token}&amp;reschedule=True"
                                   style="box-sizing: border-box ;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;margin-right: 10px;min-width: 150px;text-align: center;">
                                    Reschedule
                                </a>
                                <a href="/services/appointment/view/${object.event_id.access_token}"
                                   style="box-sizing: border-box ;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;margin-right: 10px;min-width: 150px;text-align: center;">
                                    View
                                </a>
                            </div>
                            <!--                            <div style="box-sizing: border-box ;background-color: #f4f4f4;border-radius: 3px;padding: 20px;">-->
                            <div>
                                <table style="background-color:#f4f4f4; padding: 20px">
                                    <tr style="box-sizing: border-box;">
                                        <td style="background-color: #9d668f;color: #fff;padding: 10px;margin-bottom: 20px;">
                                            <div style="box-sizing: border-box;padding: 10px;">
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;padding-bottom: 10px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('dayname', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;font-size: 50px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('day', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;text-align: center;padding: 5px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 1rem;margin: 0;">
                                                        ${object.event_id.get_interval('month', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                    </p>
                                                </div>
                                            </div>
                                            <div style="box-sizing: border-box;border-radius: 5px;background-color: #704866;padding: 10px;text-align: center;font-size: 14px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                ${not object.event_id.allday and object.event_id.get_time_interval(tz=object.event_id.appointment_type_id.appointment_tz) or ''}
                                            </div>
                                        </td>
                                        <td width="20px;"></td>
                                        <td style="padding-top: 5px;">
                                            <p>
                                                <strong>Session Details</strong>
                                            </p>
                                            <table style="width: 100%">
                                                % if not object.event_id.allday and object.event_id.duration
                                                <tr>
                                                    <th>Duration:</th>
                                                    <td>
                                                        ${(object.event_id.duration * 60)|int } minutes
                                                    </td>
                                                </tr>
                                                % endif
                                                % if object.event_id.location:
                                                <tr>
                                                    <th>Location:</th>
                                                    <td>
                                                        <a target="_blank" href="${object.event_id.zoom_join_url}">
                                                            ${object.event_id.zoom_join_url}
                                                        </a>
                                                    </td>
                                                </tr>
                                                % endif
                                                <tr>
                                                    <td colspan="2">
                                                        % if len(topics):
                                                        <strong>Description:</strong>
                                                        <div>
                                                            Odoo Accounting live support session featuring:
                                                            <ul>
                                                                % for topic in topics:
                                                                <li>
                                                                    ${topic}
                                                                </li>
                                                                % endfor
                                                            </ul>
                                                        </div>
                                                        % endif
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </body>
            </field>
            <field name="auto_delete" eval="True"/>
            <field name="user_signature" eval="False"/>
        </record>

        <!-- Remind attendees before the meeting -->
        <record id="finance_calendar_template_meeting_reminder" model="mail.template">
            <field name="name">Calendar: Finance Reminder</field>
            <field name="model_id" ref="calendar.model_calendar_attendee"/>
            <field name="subject">REMINDER: Your service session with Odoo Accounting is coming up</field>
            <field name="email_from">${object.event_id.company_id.partner_id.email_formatted | safe}</field>
            <field name="email_to">
                ${(object.email|safe)}
            </field>
            <field name="email_cc">
                ${('contact@novobi.com' if object.partner_id and object.partner_id.user_ids and object.partner_id.user_ids[0].share == False else ''|safe)}
            </field>
            <field name="reply_to">${object.event_id.company_id.email_reply_to | safe}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html" type="html">
                <body style="box-sizing: border-box;font-size: 1rem;font-weight: 400;line-height: 1.5;color: #212529;text-align: left;background-color: #fff;max-width: 600px;margin: 0 auto!important;">
                    <div style="box-sizing: border-box; margin: 25px;">
                        % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined':
                        'red'}
                        % set topics = object.event_id.get_select_topics()
                        % set company = object.event_id.company_id
                        <div style="box-sizing: border-box;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 49%;">
                                        <img class="logo" alt="logo" style="box-sizing: border-box;width: 100%;"
                                             src="/logo.png?company=${company.id}"/>
                                    </td>
                                    <td style="width: 2%;"/>
                                    <td style="width: 49%;">
                                        <div style="box-sizing: border-box ;float: right;text-align: right;right: 0;top: 20px;">
                                            <!-- <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0.5rem;font-weight: bold;line-height: 25px;font-size: 16px;text-align: right;color: #242424;">
                                                ${object.event_id.event_holder.name}
                                            </h4> -->
                                            <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 1rem;font-size: 16px;text-align: right;color: #242424;">
                                                Your Support Session is Coming Up!
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div style="box-sizing: border-box;border-bottom: solid 1px #9797972e; float:clear"></div>
                        <div style="box-sizing: border-box ;margin-top: 0px;">
                            <div style="box-sizing: border-box ;margin: 25px 0px;">
                                <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-weight: bold;line-height: 1.71;font-size: 14px;color: #242424 ;">
                                    Hello ${object.common_name},
                                </h4>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    This is a reminder that your scheduled support session is coming up!
                                </p>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Please download Zoom prior to your scheduled session so you can access the meeting.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Download Zoom for free here:
                                    <a target="_blank" href="https://zoom.us">Zoom.us</a>
                                </p>
                            </div>
                            <div style="box-sizing: border-box ;margin: 20px 0px;display: flex;justify-content: center;">
                                <a href="/services/appointment/calendar/?access_token=${object.event_id.access_token}&amp;reschedule=True"
                                   style="box-sizing: border-box ;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;margin-right: 10px;min-width: 150px;text-align: center;">
                                    Reschedule
                                </a>
                                <a href="/services/appointment/view/${object.event_id.access_token}"
                                   style="box-sizing: border-box ;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;margin-right: 10px;min-width: 150px;text-align: center;">
                                    View
                                </a>
                            </div>
                            <!--                            <div style="box-sizing: border-box ;background-color: #f4f4f4;border-radius: 3px;padding: 20px;">-->
                            <div>
                                <table style="background-color:#f4f4f4; padding: 20px">
                                    <tr style="box-sizing: border-box;">
                                        <td style="background-color: #9d668f;color: #fff;padding: 10px;margin-bottom: 20px;">
                                            <div style="box-sizing: border-box;padding: 10px;">
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;padding-bottom: 10px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('dayname', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;border-bottom: 1px solid #ffffff8a;text-align: center;font-size: 50px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                    ${object.event_id.get_interval('day', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                </div>
                                                <div style="box-sizing: border-box;text-align: center;padding: 5px;font-size: 16px;font-weight: 500;font-family: 'SF UI Display Regular';">
                                                    <p style="box-sizing: border-box;margin-top: 0;margin-bottom: 1rem;margin: 0;">
                                                        ${object.event_id.get_interval('month', tz=object.event_id.appointment_type_id.appointment_tz if not object.event_id.allday else None)}
                                                    </p>
                                                </div>
                                            </div>
                                            <div style="box-sizing: border-box;border-radius: 5px;background-color: #704866;padding: 10px;text-align: center;font-size: 14px;font-weight: bold;font-family: 'SF UI Display Regular';">
                                                ${not object.event_id.allday and object.event_id.get_time_interval(tz=object.event_id.appointment_type_id.appointment_tz) or ''}
                                            </div>
                                        </td>
                                        <td width="20px;"></td>
                                        <td style="padding-top: 5px;">
                                            <p>
                                                <strong>Session Details</strong>
                                            </p>
                                            <table style="width: 100%">
                                                % if not object.event_id.allday and object.event_id.duration
                                                <tr>
                                                    <th>Duration:</th>
                                                    <td>
                                                        ${(object.event_id.duration * 60)|int } minutes
                                                    </td>
                                                </tr>
                                                % endif
                                                % if object.event_id.location:
                                                <tr>
                                                    <th>Location:</th>
                                                    <td>
                                                        <a target="_blank" href="${object.event_id.zoom_join_url}">
                                                            ${object.event_id.zoom_join_url}
                                                        </a>
                                                    </td>
                                                </tr>
                                                % endif
                                                <tr>
                                                    <td colspan="2">
                                                        % if len(topics):
                                                        <strong>Description:</strong>
                                                        <div>
                                                            Odoo Accounting live support session featuring:
                                                            <ul>
                                                                % for topic in topics:
                                                                <li>
                                                                    ${topic}
                                                                </li>
                                                                % endfor
                                                            </ul>
                                                        </div>
                                                        % endif
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </body>
            </field>
            <field name="auto_delete" eval="True"/>
            <field name="user_signature" eval="False"/>
        </record>

        <!-- Notify attendees when another attendee cancels meeting -->
        <record id="finance_calendar_template_meeting_cancel" model="mail.template">
            <field name="name">Calendar: Finance Cancel</field>
            <field name="model_id" ref="calendar.model_calendar_attendee"/>
            <field name="subject">CANCELLATION CONFIRMED: Your service session with Odoo Accounting has been cancelled</field>
            <field name="email_from">${object.event_id.company_id.partner_id.email_formatted | safe}</field>
            <field name="email_to">
                ${(object.email|safe)}
            </field>
            <field name="email_cc">
                ${('contact@novobi.com' if object.partner_id and object.partner_id.user_ids and object.partner_id.user_ids[0].share == False else ''|safe)}
            </field>
            <field name="reply_to">${object.event_id.company_id.email_reply_to | safe}</field>
            <field name="lang">${object.partner_id.lang}</field>
            <field name="body_html" type="html">
                <body style="box-sizing: border-box;font-size: 1rem;font-weight: 400;line-height: 1.5;color: #212529;text-align: left;background-color: #fff;max-width: 600px;margin: 0 auto!important;">
                    <div style="box-sizing: border-box; margin: 25px;">
                        % set colors = {'needsAction': 'grey', 'accepted': 'green', 'tentative': '#FFFF00', 'declined':
                        'red'}
                        % set topics = object.event_id.get_select_topics()
                        % set company = object.event_id.company_id
                        <div style="box-sizing: border-box;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 49%;">
                                        <img class="logo" alt="logo" style="box-sizing: border-box;width: 100%;"
                                             src="/logo.png?company=${company.id}"/>
                                    </td>
                                    <td style="width: 2%;"/>
                                    <td style="width: 49%;">
                                        <div style="box-sizing: border-box ;float: right;text-align: right;right: 0;top: 20px;">
                                            <!-- <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0.5rem;font-weight: bold;line-height: 25px;font-size: 16px;text-align: right;color: #242424;">
                                                ${object.event_id.event_holder.name}
                                            </h4> -->
                                            <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 1rem;font-size: 16px;text-align: right;color: #242424;">
                                                Your Support Session has been Cancelled.
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div style="box-sizing: border-box;border-bottom: solid 1px #9797972e; float:clear"></div>
                        <div style="box-sizing: border-box ;margin-top: 0px;">
                            <div style="box-sizing: border-box ;margin: 25px 0px;">
                                <h4 style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-weight: bold;line-height: 1.71;font-size: 14px;color: #242424 ;">
                                    Hello ${object.common_name},
                                </h4>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Your support session/purchase has been cancelled at your request.
                                </p>
                                <br/>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Our team will response to you shortly to process a refund to you.
                                    <br/>
                                    Please click on <strong>Reschedule</strong> below if you would like to purchase a
                                    new support section.
                                </p>
                            </div>
                            <div style="box-sizing: border-box ;margin: 20px 0px;display: flex;justify-content: center;">
                                <a href="/services/appointment/view/${object.event_id.access_token}?message=cancel"
                                   style="box-sizing: border-box ;margin: 0;color: #fff;text-transform: inherit;word-wrap: break-word;white-space: normal;cursor: pointer;border: 0;border-radius: 2px;box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;padding: 0.84rem 2rem;font-size: 14px;background-color: #9d668f;height: 45px;font-weight: 500;line-height: 18px;margin-right: 10px;min-width: 150px;text-align: center;">
                                    View
                                </a>
                            </div>
                            <div style="box-sizing: border-box ;margin: 25px 0px;">
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Feel free to contact us at contact@novobi.com if you have any questions. We are
                                    happy to help!
                                </p>
                                <p style="box-sizing: border-box ;margin-top: 0;margin-bottom: 0;font-size: 14px;line-height: 1.71;letter-spacing: normal;color: #242424 ;">
                                    Thanks &amp; Regards,
                                    <br/>
                                    Novobi team.
                                </p>
                            </div>
                        </div>
                    </div>
                </body>
            </field>
            <field name="auto_delete" eval="True"/>
            <field name="user_signature" eval="False"/>
        </record>

        <!-- Notify NOVOBI admin when customer cancels meeting -->
        <record id="finance_calendar_template_meeting_cancel_for_admin" model="mail.template">
            <field name="name">Notification for admin on cancelled appointments</field>
            <field name="model_id" ref="sale.model_sale_order"/>
            <field name="subject">A client has just cancelled an appointment with us
            </field>
            <field name="email_from">${object.company_id.partner_id.email_formatted | safe}</field>
            <field name="email_to">
                contact@novobi.com,finance@novobi.com
            </field>
            <field name="reply_to">${object.company_id.email_reply_to | safe}</field>
            <field name="body_html" type="html">
                <body style="box-sizing: border-box;font-size: 1rem;font-weight: 400;line-height: 1.5;color: #212529;text-align: left;background-color: #fff;max-width: 600px;margin: 0 auto!important;">
                    <div style="box-sizing: border-box; margin: 25px;">
                        % set transaction = ctx.get('transaction')
                        % set company = object.company_id
                        <div style="box-sizing: border-box;">
                            <table style="width: 100%;">
                                <tr>
                                    <td style="width: 50%;">
                                        <img class="logo" alt="logo" style="box-sizing: border-box;width: 100%;"
                                             src="/logo.png?company=${company.id}"/>
                                    </td>
                                    <td style="width: 50%;"/>
                                </tr>
                            </table>
                        </div>
                        <div style="box-sizing: border-box;border-bottom: solid 1px #9797972e; float:clear"></div>
                        <div style="box-sizing: border-box ;margin-top: 0px;">
                           <table style="background:white;border-spacing:0; text-align:center; width: 100%">
                                <thead>
                                    <tr>
                                        <th style="width: 20%">Client Name</th>
                                        <th style="width: 20%">Client Email</th>
                                        <th style="width: 15%">Sale Order</th>
                                        <th style="width: 15%">Payment Amount</th>
                                        <th style="width: 20%">Payment Date</th>
                                        <th style="width: 10%">Payment Method</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>${object.partner_id.name}</td>
                                        <td>${object.partner_id.email}</td>
                                        <td>${object.name}</td>
                                        <td>${transaction.amount}</td>
                                        <td>${transaction.date.strftime('%Y-%m-%d')}</td>
                                        <td>${transaction.acquirer_id.name}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </body>
            </field>
            <field name="auto_delete" eval="True"/>
            <field name="user_signature" eval="False"/>
        </record>
    </data>
</odoo>

